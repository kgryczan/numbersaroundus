<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Numbers around us">
<meta name="dcterms.date" content="2024-06-13">

<title>Joins Are No Mystery Anymore: Hands-On Tutorial — Part 3 – Numbers Around Us</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-697306ee647f3aecb60be57249203282.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-3fe3df12cb322cd60d4f50ab5ce79ec8.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-622041c3a4c8f37608cdf3f999a2327b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-923b75c99b049d6672f44a19a661fd30.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Numbers Around Us</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../last-articles.html"> 
<span class="menu-text">Newest articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../challenges/index.html"> 
<span class="menu-text">Challenges</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../bi/index.html"> 
<span class="menu-text">Business Intelligence</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ds/index.html"> 
<span class="menu-text">Data Science</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../dp/index.html"> 
<span class="menu-text">Data Philosophy</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com" title="Github" class="quarto-navigation-tool px-1" aria-label="Github"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Joins Are No Mystery Anymore: Hands-On Tutorial — Part 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Numbers around us </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="images/join3.jpg" class="img-fluid"></p>
<p>Welcome back to the final installment of our series, “Joins Are No Mystery Anymore: Hands-On Tutorial.” In the previous weeks, we covered the foundational and advanced join techniques, including Inner Join, Left Join, Right Join, Full Join, Semi Join, Anti Join, Cross Join, Natural Join, Self Join, and Equi Join. We’ve seen how these joins can be applied to real-life scenarios to solve various data problems.</p>
<p>Today, we’ll dive even deeper into the world of data joins by exploring Non-Equi Joins, Rolling Joins, Overlap Joins, and Fuzzy Joins. These specialized joins will help you handle more complex data scenarios, such as matching based on non-equality conditions, finding the nearest matches, and dealing with approximate or fuzzy data.</p>
<p>Let’s get started with our first join of the day: <strong>Non-Equi Join</strong>.</p>
<section id="non-equi-join" class="level3">
<h3 class="anchored" data-anchor-id="non-equi-join">Non-Equi Join</h3>
<p>A Non-Equi Join is used to join tables based on non-equality conditions, such as greater than (&gt;) or less than (&lt;). This type of join is particularly useful when dealing with ranges or thresholds.</p>
<section id="explanation-of-the-scenario" class="level4">
<h4 class="anchored" data-anchor-id="explanation-of-the-scenario">Explanation of the Scenario</h4>
<p>In this scenario, we have sales and targets. We want to find sales that exceeded the targets. This helps in identifying successful sales that met or surpassed the set goals.</p>
</section>
<section id="description-of-the-datasets" class="level4">
<h4 class="anchored" data-anchor-id="description-of-the-datasets">Description of the Datasets</h4>
<p>We will use two datasets:</p>
<ul>
<li><code>sales</code>: Contains information about sales.</li>
<li>Columns: <code>sale_id</code>, <code>amount</code>, <code>date</code></li>
<li><code>targets</code>: Contains information about sales targets.</li>
<li>Columns: <code>target_id</code>, <code>target_amount</code>, <code>target_date</code></li>
</ul>
</section>
<section id="step-by-step-code-examples" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-code-examples">Step-by-Step Code Examples</h4>
<p><strong>Loading the datasets:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the datasets</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"non_equi_join_data.RData"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the datasets</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sales)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 20 × 3</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>   sale_id amount date      </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>     <span class="sc">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>    </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>       <span class="dv">1</span>    <span class="dv">178</span> <span class="dv">2024-01-01</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>       <span class="dv">2</span>    <span class="dv">219</span> <span class="dv">2024-01-02</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>       <span class="dv">3</span>    <span class="dv">111</span> <span class="dv">2024-01-03</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>       <span class="dv">4</span>    <span class="dv">266</span> <span class="dv">2024-01-04</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>       <span class="dv">5</span>    <span class="dv">208</span> <span class="dv">2024-01-05</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>       <span class="dv">6</span>    <span class="dv">231</span> <span class="dv">2024-01-06</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>       <span class="dv">7</span>    <span class="dv">296</span> <span class="dv">2024-01-07</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>       <span class="dv">8</span>    <span class="dv">242</span> <span class="dv">2024-01-08</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>       <span class="dv">9</span>    <span class="dv">149</span> <span class="dv">2024-01-09</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>      <span class="dv">10</span>    <span class="dv">245</span> <span class="dv">2024-01-10</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>      <span class="dv">11</span>    <span class="dv">137</span> <span class="dv">2024-01-11</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>      <span class="dv">12</span>    <span class="dv">175</span> <span class="dv">2024-01-12</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>      <span class="dv">13</span>    <span class="dv">209</span> <span class="dv">2024-01-13</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>      <span class="dv">14</span>    <span class="dv">133</span> <span class="dv">2024-01-14</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>      <span class="dv">15</span>    <span class="dv">256</span> <span class="dv">2024-01-15</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>      <span class="dv">16</span>    <span class="dv">128</span> <span class="dv">2024-01-16</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>      <span class="dv">17</span>    <span class="dv">107</span> <span class="dv">2024-01-17</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>      <span class="dv">18</span>    <span class="dv">220</span> <span class="dv">2024-01-18</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>      <span class="dv">19</span>    <span class="dv">295</span> <span class="dv">2024-01-19</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>      <span class="dv">20</span>    <span class="dv">235</span> <span class="dv">2024-01-20</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(targets)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 10 × 3</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>   target_id target_amount target_date</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>       <span class="sc">&lt;</span>int<span class="sc">&gt;</span>         <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>     </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>         <span class="dv">1</span>           <span class="dv">100</span> <span class="dv">2024-01-01</span> </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>         <span class="dv">2</span>           <span class="dv">120</span> <span class="dv">2024-01-06</span> </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>         <span class="dv">3</span>           <span class="dv">140</span> <span class="dv">2024-01-11</span> </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>         <span class="dv">4</span>           <span class="dv">160</span> <span class="dv">2024-01-16</span> </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>         <span class="dv">5</span>           <span class="dv">180</span> <span class="dv">2024-01-21</span> </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>         <span class="dv">6</span>           <span class="dv">200</span> <span class="dv">2024-01-26</span> </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>         <span class="dv">7</span>           <span class="dv">220</span> <span class="dv">2024-01-31</span> </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>         <span class="dv">8</span>           <span class="dv">240</span> <span class="dv">2024-02-05</span> </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>         <span class="dv">9</span>           <span class="dv">260</span> <span class="dv">2024-02-10</span> </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>        <span class="dv">10</span>           <span class="dv">280</span> <span class="dv">2024-02-15</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Performing the Non-Equi Join</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data.table</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sales_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(sales)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>targets_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(targets)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the non-equi join</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>successful_sales <span class="ot">&lt;-</span> sales_dt[targets_dt, on <span class="ot">=</span> .(amount <span class="sc">&gt;</span> target_amount), nomatch <span class="ot">=</span> <span class="dv">0</span>]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(successful_sales)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>     sale_id amount       date target_id target_date</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>       <span class="sc">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>Date<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span>      <span class="er">&lt;</span>Date<span class="sc">&gt;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span>       <span class="dv">1</span>    <span class="dv">100</span> <span class="dv">2024-01-01</span>         <span class="dv">1</span>  <span class="dv">2024-01-01</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">:</span>       <span class="dv">2</span>    <span class="dv">100</span> <span class="dv">2024-01-02</span>         <span class="dv">1</span>  <span class="dv">2024-01-01</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span><span class="sc">:</span>       <span class="dv">3</span>    <span class="dv">100</span> <span class="dv">2024-01-03</span>         <span class="dv">1</span>  <span class="dv">2024-01-01</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span><span class="sc">:</span>       <span class="dv">4</span>    <span class="dv">100</span> <span class="dv">2024-01-04</span>         <span class="dv">1</span>  <span class="dv">2024-01-01</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span><span class="sc">:</span>       <span class="dv">5</span>    <span class="dv">100</span> <span class="dv">2024-01-05</span>         <span class="dv">1</span>  <span class="dv">2024-01-01</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a> <span class="sc">---</span>                                                 </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="dv">106</span><span class="sc">:</span>       <span class="dv">4</span>    <span class="dv">260</span> <span class="dv">2024-01-04</span>         <span class="dv">9</span>  <span class="dv">2024-02-10</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="dv">107</span><span class="sc">:</span>       <span class="dv">7</span>    <span class="dv">260</span> <span class="dv">2024-01-07</span>         <span class="dv">9</span>  <span class="dv">2024-02-10</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="dv">108</span><span class="sc">:</span>      <span class="dv">19</span>    <span class="dv">260</span> <span class="dv">2024-01-19</span>         <span class="dv">9</span>  <span class="dv">2024-02-10</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="dv">109</span><span class="sc">:</span>       <span class="dv">7</span>    <span class="dv">280</span> <span class="dv">2024-01-07</span>        <span class="dv">10</span>  <span class="dv">2024-02-15</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="dv">110</span><span class="sc">:</span>      <span class="dv">19</span>    <span class="dv">280</span> <span class="dv">2024-01-19</span>        <span class="dv">10</span>  <span class="dv">2024-02-15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Explanation of the Code:</strong></p>
<ul>
<li>We first load the datasets using the <code>load</code> function.</li>
<li>We then convert the <code>sales</code> and <code>targets</code> datasets to data.tables for efficient non-equi joins.</li>
<li>We perform the non-equi join using the <code>on</code> argument to specify the non-equality condition (<code>amount &gt; target_amount</code>).</li>
<li>The <code>nomatch = 0</code> argument ensures that only rows with matches are included in the result.</li>
<li>Finally, we display the result to see which sales exceeded the targets.</li>
</ul>
</section>
<section id="interpretation-of-results" class="level4">
<h4 class="anchored" data-anchor-id="interpretation-of-results">Interpretation of Results</h4>
<p>The resulting dataset <code>successful_sales</code> contains only the rows from the <code>sales</code> dataset where the <code>amount</code> exceeds the <code>target_amount</code> from the <code>targets</code> dataset.</p>
</section>
<section id="homework-for-readers" class="level4">
<h4 class="anchored" data-anchor-id="homework-for-readers">Homework for Readers</h4>
<p>In the same <code>non_equi_join_data.RData</code> file, there is another set of datasets for a more creative scenario. You will find:</p>
<ul>
<li><code>students</code>: Contains information about students.</li>
<li>Columns: <code>student_id</code>, <code>name</code>, <code>grade</code></li>
<li><code>scholarship_thresholds</code>: Contains information about scholarship thresholds.</li>
<li>Columns: <code>threshold_id</code>, <code>min_grade</code></li>
</ul>
<p>Your task is to perform a non-equi join on these datasets to match students with scholarship thresholds they exceed. Use the <code>grade</code> and <code>min_grade</code> columns for the non-equality condition.</p>
</section>
</section>
<section id="rolling-join" class="level3">
<h3 class="anchored" data-anchor-id="rolling-join">Rolling Join</h3>
<p>A Rolling Join is used to join two tables based on a key column, with the ability to match the nearest value when an exact match is not found. This is particularly useful for time series data or any scenario where you need to find the closest preceding or following value.</p>
<section id="explanation-of-the-scenario-1" class="level4">
<h4 class="anchored" data-anchor-id="explanation-of-the-scenario-1">Explanation of the Scenario</h4>
<p>In this scenario, we have stock prices and company events. We want to join these tables to match stock prices with the nearest company events. This helps in understanding how company events might have influenced stock prices.</p>
</section>
<section id="description-of-the-datasets-1" class="level4">
<h4 class="anchored" data-anchor-id="description-of-the-datasets-1">Description of the Datasets</h4>
<p>We will use two datasets:</p>
<ul>
<li><code>stock_prices</code>: Contains information about stock prices.</li>
<li>Columns: <code>date</code>, <code>stock_id</code>, <code>price</code></li>
<li><code>events</code>: Contains information about company events.</li>
<li>Columns: <code>event_id</code>, <code>stock_id</code>, <code>event_date</code>, <code>description</code></li>
</ul>
</section>
<section id="step-by-step-code-examples-1" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-code-examples-1">Step-by-Step Code Examples</h4>
<p><strong>Loading the datasets:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the datasets</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"rolling_join_data.RData"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the datasets</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stock_prices)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 20 × 3</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>   date       stock_id price</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>date<span class="sc">&gt;</span>        <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> <span class="dv">2024-01-01</span>        <span class="dv">1</span>   <span class="dv">106</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> <span class="dv">2024-01-02</span>        <span class="dv">1</span>   <span class="dv">106</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> <span class="dv">2024-01-03</span>        <span class="dv">1</span>   <span class="dv">108</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> <span class="dv">2024-01-04</span>        <span class="dv">1</span>   <span class="dv">103</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="dv">2024-01-05</span>        <span class="dv">1</span>   <span class="dv">103</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> <span class="dv">2024-01-06</span>        <span class="dv">1</span>   <span class="dv">109</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> <span class="dv">2024-01-07</span>        <span class="dv">1</span>   <span class="dv">101</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> <span class="dv">2024-01-08</span>        <span class="dv">1</span>   <span class="dv">104</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> <span class="dv">2024-01-09</span>        <span class="dv">1</span>   <span class="dv">107</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">2024-01-10</span>        <span class="dv">1</span>   <span class="dv">101</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="dv">2024-01-11</span>        <span class="dv">1</span>   <span class="dv">108</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> <span class="dv">2024-01-12</span>        <span class="dv">1</span>   <span class="dv">102</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="dv">2024-01-13</span>        <span class="dv">1</span>   <span class="dv">107</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> <span class="dv">2024-01-14</span>        <span class="dv">1</span>   <span class="dv">108</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> <span class="dv">2024-01-15</span>        <span class="dv">1</span>   <span class="dv">101</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> <span class="dv">2024-01-16</span>        <span class="dv">1</span>   <span class="dv">100</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> <span class="dv">2024-01-17</span>        <span class="dv">1</span>   <span class="dv">104</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> <span class="dv">2024-01-18</span>        <span class="dv">1</span>   <span class="dv">104</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> <span class="dv">2024-01-19</span>        <span class="dv">1</span>   <span class="dv">104</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span> <span class="dv">2024-01-20</span>        <span class="dv">1</span>   <span class="dv">101</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(events)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3 × 4</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  event_id stock_id event_date description      </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>     <span class="sc">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>     <span class="er">&lt;</span>chr<span class="sc">&gt;</span>            </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-05</span> Quarterly Meeting</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-15</span> Product Launch   </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>        <span class="dv">3</span>        <span class="dv">1</span> <span class="dv">2024-01-25</span> Earnings Call </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Performing the Rolling Join</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data.table</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>stock_prices_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(stock_prices)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>events_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(events)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set keys for rolling join</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(stock_prices_dt, stock_id, date)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(events_dt, stock_id, event_date)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the rolling join</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>stock_events <span class="ot">&lt;-</span> events_dt[stock_prices_dt, roll <span class="ot">=</span> <span class="st">"nearest"</span>, on <span class="ot">=</span> .(stock_id, <span class="at">event_date =</span> date)]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stock_events)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>Key<span class="sc">:</span> <span class="er">&lt;</span>stock_id, event_date<span class="sc">&gt;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    event_id stock_id event_date       description price</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>       <span class="sc">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>num<span class="sc">&gt;</span>     <span class="er">&lt;</span>Date<span class="sc">&gt;</span>            <span class="er">&lt;</span>char<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-01</span> Quarterly Meeting   <span class="dv">106</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-02</span> Quarterly Meeting   <span class="dv">106</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-03</span> Quarterly Meeting   <span class="dv">108</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-04</span> Quarterly Meeting   <span class="dv">103</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-05</span> Quarterly Meeting   <span class="dv">103</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-06</span> Quarterly Meeting   <span class="dv">109</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-07</span> Quarterly Meeting   <span class="dv">101</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-08</span> Quarterly Meeting   <span class="dv">104</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-09</span> Quarterly Meeting   <span class="dv">107</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span><span class="sc">:</span>        <span class="dv">1</span>        <span class="dv">1</span> <span class="dv">2024-01-10</span> Quarterly Meeting   <span class="dv">101</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-11</span>    Product Launch   <span class="dv">108</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-12</span>    Product Launch   <span class="dv">102</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-13</span>    Product Launch   <span class="dv">107</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-14</span>    Product Launch   <span class="dv">108</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-15</span>    Product Launch   <span class="dv">101</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-16</span>    Product Launch   <span class="dv">100</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-17</span>    Product Launch   <span class="dv">104</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-18</span>    Product Launch   <span class="dv">104</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-19</span>    Product Launch   <span class="dv">104</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span><span class="sc">:</span>        <span class="dv">2</span>        <span class="dv">1</span> <span class="dv">2024-01-20</span>    Product Launch   <span class="dv">101</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    event_id stock_id event_date       description price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Explanation of the Code:</strong></p>
<ul>
<li>We first load the datasets using the <code>load</code> function.</li>
<li>We then convert the <code>stock_prices</code> and <code>events</code> datasets to data.tables for efficient rolling joins.</li>
<li>We set the keys for the rolling join using the <code>setkey</code> function on the <code>stock_id</code> and <code>date</code> columns for <code>stock_prices</code>, and <code>stock_id</code> and <code>event_date</code> columns for <code>events</code>.</li>
<li>We perform the rolling join using the <code>roll</code> argument set to <code>"nearest"</code>, which finds the closest match in terms of date.</li>
<li>Finally, we display the result to see the stock prices matched with the nearest company events.</li>
</ul>
</section>
<section id="interpretation-of-results-1" class="level4">
<h4 class="anchored" data-anchor-id="interpretation-of-results-1">Interpretation of Results</h4>
<p>The resulting dataset <code>stock_events</code> contains the rows from the <code>stock_prices</code> dataset matched with the nearest preceding or following event from the <code>events</code> dataset based on the <code>date</code> and <code>event_date</code> columns.</p>
</section>
<section id="homework-for-readers-1" class="level4">
<h4 class="anchored" data-anchor-id="homework-for-readers-1">Homework for Readers</h4>
<p>In the same <code>rolling_join_data.RData</code> file, there is another set of datasets for a more creative scenario. You will find:</p>
<ul>
<li><code>weather_records</code>: Contains information about weather records.</li>
<li>Columns: <code>record_id</code>, <code>date</code>, <code>temperature</code></li>
<li><code>weather_events</code>: Contains information about significant weather events.</li>
<li>Columns: <code>event_id</code>, <code>event_date</code>, <code>event_description</code></li>
</ul>
<p>Your task is to perform a rolling join on these datasets to match weather records with the nearest significant weather events. Use the <code>date</code> and <code>event_date</code> columns for the rolling join.</p>
</section>
</section>
<section id="overlap-join" class="level3">
<h3 class="anchored" data-anchor-id="overlap-join">Overlap Join</h3>
<p>An Overlap Join is used to join tables based on overlapping ranges of values. This type of join is particularly useful for scenarios where you need to find overlapping time periods or other ranges.</p>
<section id="explanation-of-the-scenario-2" class="level4">
<h4 class="anchored" data-anchor-id="explanation-of-the-scenario-2">Explanation of the Scenario</h4>
<p>In this scenario, we have hotel bookings and we want to find overlapping bookings. This helps in identifying potential overbookings and managing reservations effectively.</p>
</section>
<section id="description-of-the-datasets-2" class="level4">
<h4 class="anchored" data-anchor-id="description-of-the-datasets-2">Description of the Datasets</h4>
<p>We will use one dataset:</p>
<ul>
<li><code>bookings</code>: Contains information about hotel bookings.</li>
<li>Columns: <code>booking_id</code>, <code>room_id</code>, <code>start_date</code>, <code>end_date</code></li>
</ul>
</section>
<section id="step-by-step-code-examples-2" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-code-examples-2">Step-by-Step Code Examples</h4>
<p><strong>Loading the dataset:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fuzzyjoin)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"overlap_join_data.RData"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the dataset</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bookings)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 20 × 4</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>   booking_id room_id start_date end_date  </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="sc">&lt;</span>int<span class="sc">&gt;</span>   <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>     <span class="er">&lt;</span>date<span class="sc">&gt;</span>    </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>          <span class="dv">1</span>     <span class="dv">109</span> <span class="dv">2024-01-01</span> <span class="dv">2024-01-05</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>          <span class="dv">2</span>     <span class="dv">111</span> <span class="dv">2024-01-03</span> <span class="dv">2024-01-07</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>          <span class="dv">3</span>     <span class="dv">118</span> <span class="dv">2024-01-05</span> <span class="dv">2024-01-09</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>          <span class="dv">4</span>     <span class="dv">104</span> <span class="dv">2024-01-07</span> <span class="dv">2024-01-11</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>          <span class="dv">5</span>     <span class="dv">103</span> <span class="dv">2024-01-09</span> <span class="dv">2024-01-13</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>          <span class="dv">6</span>     <span class="dv">103</span> <span class="dv">2024-01-11</span> <span class="dv">2024-01-15</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>          <span class="dv">7</span>     <span class="dv">101</span> <span class="dv">2024-01-13</span> <span class="dv">2024-01-17</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>          <span class="dv">8</span>     <span class="dv">101</span> <span class="dv">2024-01-15</span> <span class="dv">2024-01-19</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>          <span class="dv">9</span>     <span class="dv">101</span> <span class="dv">2024-01-17</span> <span class="dv">2024-01-21</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>         <span class="dv">10</span>     <span class="dv">103</span> <span class="dv">2024-01-19</span> <span class="dv">2024-01-23</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>         <span class="dv">11</span>     <span class="dv">101</span> <span class="dv">2024-01-21</span> <span class="dv">2024-01-25</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>         <span class="dv">12</span>     <span class="dv">116</span> <span class="dv">2024-01-23</span> <span class="dv">2024-01-27</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>         <span class="dv">13</span>     <span class="dv">111</span> <span class="dv">2024-01-25</span> <span class="dv">2024-01-29</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>         <span class="dv">14</span>     <span class="dv">116</span> <span class="dv">2024-01-27</span> <span class="dv">2024-01-31</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>         <span class="dv">15</span>     <span class="dv">104</span> <span class="dv">2024-01-29</span> <span class="dv">2024-02-02</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>         <span class="dv">16</span>     <span class="dv">103</span> <span class="dv">2024-01-31</span> <span class="dv">2024-02-04</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>         <span class="dv">17</span>     <span class="dv">110</span> <span class="dv">2024-02-02</span> <span class="dv">2024-02-06</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>         <span class="dv">18</span>     <span class="dv">114</span> <span class="dv">2024-02-04</span> <span class="dv">2024-02-08</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>         <span class="dv">19</span>     <span class="dv">111</span> <span class="dv">2024-02-06</span> <span class="dv">2024-02-10</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>         <span class="dv">20</span>     <span class="dv">102</span> <span class="dv">2024-02-08</span> <span class="dv">2024-02-12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Performing the Overlap Join</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the overlap join</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>overlapping_bookings <span class="ot">&lt;-</span> <span class="fu">fuzzy_left_join</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  bookings, bookings,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"room_id"</span> <span class="ot">=</span> <span class="st">"room_id"</span>, <span class="st">"start_date"</span> <span class="ot">=</span> <span class="st">"end_date"</span>, <span class="st">"end_date"</span> <span class="ot">=</span> <span class="st">"start_date"</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">match_fun =</span> <span class="fu">list</span>(<span class="st">`</span><span class="at">==</span><span class="st">`</span>, <span class="st">`</span><span class="at">&lt;=</span><span class="st">`</span>, <span class="st">`</span><span class="at">&gt;=</span><span class="st">`</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(booking_id.x <span class="sc">!=</span> booking_id.y)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overlapping_bookings)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 12 × 8</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>   booking_id.x room_id.x start_date.x end_date.x booking_id.y room_id.y start_date.y end_date.y</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>          <span class="sc">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>       <span class="er">&lt;</span>date<span class="sc">&gt;</span>            <span class="er">&lt;</span>int<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>       <span class="er">&lt;</span>date<span class="sc">&gt;</span>    </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>            <span class="dv">5</span>       <span class="dv">103</span> <span class="dv">2024-01-09</span>   <span class="dv">2024-01-13</span>            <span class="dv">6</span>       <span class="dv">103</span> <span class="dv">2024-01-11</span>   <span class="dv">2024-01-15</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>            <span class="dv">6</span>       <span class="dv">103</span> <span class="dv">2024-01-11</span>   <span class="dv">2024-01-15</span>            <span class="dv">5</span>       <span class="dv">103</span> <span class="dv">2024-01-09</span>   <span class="dv">2024-01-13</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>            <span class="dv">7</span>       <span class="dv">101</span> <span class="dv">2024-01-13</span>   <span class="dv">2024-01-17</span>            <span class="dv">8</span>       <span class="dv">101</span> <span class="dv">2024-01-15</span>   <span class="dv">2024-01-19</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span>            <span class="dv">7</span>       <span class="dv">101</span> <span class="dv">2024-01-13</span>   <span class="dv">2024-01-17</span>            <span class="dv">9</span>       <span class="dv">101</span> <span class="dv">2024-01-17</span>   <span class="dv">2024-01-21</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span>            <span class="dv">8</span>       <span class="dv">101</span> <span class="dv">2024-01-15</span>   <span class="dv">2024-01-19</span>            <span class="dv">7</span>       <span class="dv">101</span> <span class="dv">2024-01-13</span>   <span class="dv">2024-01-17</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span>            <span class="dv">8</span>       <span class="dv">101</span> <span class="dv">2024-01-15</span>   <span class="dv">2024-01-19</span>            <span class="dv">9</span>       <span class="dv">101</span> <span class="dv">2024-01-17</span>   <span class="dv">2024-01-21</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span>            <span class="dv">9</span>       <span class="dv">101</span> <span class="dv">2024-01-17</span>   <span class="dv">2024-01-21</span>            <span class="dv">7</span>       <span class="dv">101</span> <span class="dv">2024-01-13</span>   <span class="dv">2024-01-17</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span>            <span class="dv">9</span>       <span class="dv">101</span> <span class="dv">2024-01-17</span>   <span class="dv">2024-01-21</span>            <span class="dv">8</span>       <span class="dv">101</span> <span class="dv">2024-01-15</span>   <span class="dv">2024-01-19</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span>            <span class="dv">9</span>       <span class="dv">101</span> <span class="dv">2024-01-17</span>   <span class="dv">2024-01-21</span>           <span class="dv">11</span>       <span class="dv">101</span> <span class="dv">2024-01-21</span>   <span class="dv">2024-01-25</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>           <span class="dv">11</span>       <span class="dv">101</span> <span class="dv">2024-01-21</span>   <span class="dv">2024-01-25</span>            <span class="dv">9</span>       <span class="dv">101</span> <span class="dv">2024-01-17</span>   <span class="dv">2024-01-21</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>           <span class="dv">12</span>       <span class="dv">116</span> <span class="dv">2024-01-23</span>   <span class="dv">2024-01-27</span>           <span class="dv">14</span>       <span class="dv">116</span> <span class="dv">2024-01-27</span>   <span class="dv">2024-01-31</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>           <span class="dv">14</span>       <span class="dv">116</span> <span class="dv">2024-01-27</span>   <span class="dv">2024-01-31</span>           <span class="dv">12</span>       <span class="dv">116</span> <span class="dv">2024-01-23</span>   <span class="dv">2024-01-27</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Explanation of the Code:</strong></p>
<ul>
<li>We first load the dataset using the <code>load</code> function.</li>
<li>We then use the <code>fuzzy_left_join</code> function from the <code>fuzzyjoin</code> package to perform the overlap join. The <code>by</code> argument specifies the columns to join on, and the <code>match_fun</code> argument specifies the matching conditions for each column.</li>
<li>We filter the results to exclude self-joins by ensuring <code>booking_id.x</code> is not equal to <code>booking_id.y</code>.</li>
<li>Finally, we display the result to see the overlapping bookings.</li>
</ul>
</section>
<section id="interpretation-of-results-2" class="level4">
<h4 class="anchored" data-anchor-id="interpretation-of-results-2">Interpretation of Results</h4>
<p>The resulting dataset <code>overlapping_bookings</code> contains pairs of rows from the <code>bookings</code> dataset where the bookings overlap based on the <code>room_id</code>, <code>start_date</code>, and <code>end_date</code> columns.</p>
</section>
<section id="homework-for-readers-2" class="level4">
<h4 class="anchored" data-anchor-id="homework-for-readers-2">Homework for Readers</h4>
<p>In the same <code>overlap_join_data.RData</code> file, there is another set of datasets for a more creative scenario. You will find:</p>
<ul>
<li><code>projects</code>: Contains information about projects.</li>
<li>Columns: <code>project_id</code>, <code>project_name</code>, <code>start_date</code>, <code>end_date</code></li>
</ul>
<p>Your task is to perform an overlap join on these datasets to find overlapping project timelines. Use the <code>start_date</code> and <code>end_date</code> columns for the overlap join.</p>
</section>
</section>
<section id="fuzzy-join" class="level3">
<h3 class="anchored" data-anchor-id="fuzzy-join">Fuzzy Join</h3>
<p>A Fuzzy Join is used to join tables based on approximate or “fuzzy” matching of key columns. Unlike traditional joins, which require exact matches between columns, fuzzy joins allow for matches based on similarity, proximity, or other non-exact criteria. This is particularly useful when dealing with data that has inconsistencies, such as typos, different naming conventions, or slight variations in values.</p>
<p>Fuzzy joins can be used in various scenarios, such as:</p>
<ul>
<li>Merging customer records from different sources where names or addresses might be slightly different.</li>
<li>Matching products from different databases where product names might vary.</li>
<li>Combining historical documents with different naming conventions.</li>
</ul>
<p>Fuzzy joins leverage different methods of similarity measurement, such as string distance (e.g., Levenshtein distance), numeric proximity, or custom matching functions, to find the best possible matches between rows.</p>
<section id="explanation-of-the-scenario-3" class="level4">
<h4 class="anchored" data-anchor-id="explanation-of-the-scenario-3">Explanation of the Scenario</h4>
<p>In this scenario, we have customer records from two different sources. We want to join these tables to combine records that refer to the same customers, even if there are slight differences in the names or addresses. This helps in consolidating customer data from multiple sources into a single, unified view.</p>
</section>
<section id="description-of-the-datasets-3" class="level4">
<h4 class="anchored" data-anchor-id="description-of-the-datasets-3">Description of the Datasets</h4>
<p>We will use two datasets:</p>
<ul>
<li><code>customer_records_A</code>: Contains customer information from source A.</li>
<li>Columns: <code>customer_id</code>, <code>name</code>, <code>address</code></li>
<li><code>customer_records_B</code>: Contains customer information from source B.</li>
<li>Columns: <code>customer_id</code>, <code>name</code>, <code>address</code></li>
</ul>
</section>
<section id="step-by-step-code-examples-3" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-code-examples-3">Step-by-Step Code Examples</h4>
<p><strong>Loading the datasets:</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fuzzyjoin)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the datasets</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"fuzzy_join_data.RData"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the datasets</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(customer_records_A)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                Name                Address ID</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>        Terry Welsh       <span class="dv">5028</span> Paddock Way  <span class="dv">1</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>        Robin Lewis      <span class="dv">3415</span> Photinia Ave  <span class="dv">2</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      Tyrone Carter         <span class="dv">5697</span> Smokey Ln  <span class="dv">3</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>        Noah Fuller      <span class="dv">4028</span> Northaven Rd  <span class="dv">4</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     Heather Barnes      <span class="dv">5530</span> First Street  <span class="dv">5</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>          Alex Peck  <span class="dv">7132</span> Mockingbird Hill  <span class="dv">6</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>   Alfredo Martinez         <span class="dv">8920</span> Smokey Ln  <span class="dv">7</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>     Adrian Morales         <span class="dv">6567</span> Nowlin Rd  <span class="dv">8</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>       Melvin Paine        <span class="dv">8310</span> Fincher Rd  <span class="dv">9</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>     Harry Edwards    <span class="dv">8848</span> Valley View Ln <span class="dv">10</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> Esther Williamson          <span class="dv">2644</span> Daisy Dr <span class="dv">11</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>   Stella Campbell   <span class="dv">9021</span> E Sandy Lake Rd <span class="dv">12</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>    Lawrence Grant      <span class="dv">3221</span> First Street <span class="dv">13</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>       Vivan Perez        <span class="dv">996</span> Wycliff Ave <span class="dv">14</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>        Eli Brewer  <span class="dv">7344</span> Wheeler Ridge Dr <span class="dv">15</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>     Edward Wagner      <span class="dv">7174</span> W Sherman Dr <span class="dv">16</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>        Dwayne Day <span class="dv">2115</span> Groveland Terrace <span class="dv">17</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>      Erika Flores         <span class="dv">3566</span> Nowlin Rd <span class="dv">18</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>   Nicholas Nelson           <span class="dv">7867</span> Dane St <span class="dv">19</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>       Wade Willis    <span class="dv">8608</span> Pecan Acres Ln <span class="dv">20</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(customer_records_B)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>               Name                Address ID</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       Terry Welch       <span class="dv">5028</span> Paddock Way  <span class="dv">1</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  Courtney Elliott        <span class="dv">6526</span> Cackson St  <span class="dv">2</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      Tyron Carter         <span class="dv">5697</span> Smokey Ln  <span class="dv">3</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      Noah Fueller      <span class="dv">4028</span> Northaven Rd  <span class="dv">4</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     Jesus Herrera       <span class="dv">722</span> Hillcrest Rd  <span class="dv">5</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>        Isaac Neal     <span class="dv">308</span> W Campbell Ave  <span class="dv">6</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>      Annette Carr      <span class="dv">2087</span> Photinia Ave  <span class="dv">7</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>      Rebecca Boyd      <span class="dv">7584</span> Homestead Rd  <span class="dv">8</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>      Melvin Payne        <span class="dv">8310</span> Fincher Rd  <span class="dv">9</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>      Irma Bowman      <span class="dv">9065</span> Valwood Pkwy <span class="dv">10</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>  Heather Wallace         <span class="dv">95</span> Railroad St <span class="dv">11</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>      Janice West        <span class="dv">1545</span> W Pecan St <span class="dv">12</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>    Dianne Chavez        <span class="dv">326</span> Robinson Rd <span class="dv">13</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>     Vivian Perez        <span class="dv">996</span> Wycliff Ave <span class="dv">14</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>      Dustin Wood <span class="dv">2677</span> Groveland Terrace <span class="dv">15</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span>     Calvin Jones      <span class="dv">5859</span> Samaritan Dr <span class="dv">16</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>     Tara Carroll  <span class="dv">2215</span> Rolling Green Rd <span class="dv">17</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span>  Francis Gardner         <span class="dv">1242</span> Sunset St <span class="dv">18</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span>  Bryan Henderson      <span class="dv">5781</span> Ranchview Dr <span class="dv">19</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>    Michelle Bell     <span class="dv">9072</span> Westheimer Rd <span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Performing the Fuzzy Join</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the fuzzy join</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>customer_matches <span class="ot">&lt;-</span> <span class="fu">stringdist_left_join</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  customer_records_A, customer_records_B,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"Name"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_dist =</span> <span class="dv">2</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance_col =</span> <span class="st">"dist"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dist <span class="sc">&lt;</span> <span class="dv">2</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(customer_matches)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>         Name.x         Address.x ID.x       Name.y         Address.y ID.y dist</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   Terry Welsh  <span class="dv">5028</span> Paddock Way    <span class="dv">1</span>  Terry Welch  <span class="dv">5028</span> Paddock Way    <span class="dv">1</span>    <span class="dv">1</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Tyrone Carter    <span class="dv">5697</span> Smokey Ln    <span class="dv">3</span> Tyron Carter    <span class="dv">5697</span> Smokey Ln    <span class="dv">3</span>    <span class="dv">1</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   Noah Fuller <span class="dv">4028</span> Northaven Rd    <span class="dv">4</span> Noah Fueller <span class="dv">4028</span> Northaven Rd    <span class="dv">4</span>    <span class="dv">1</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  Melvin Paine   <span class="dv">8310</span> Fincher Rd    <span class="dv">9</span> Melvin Payne   <span class="dv">8310</span> Fincher Rd    <span class="dv">9</span>    <span class="dv">1</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   Vivan Perez   <span class="dv">996</span> Wycliff Ave   <span class="dv">14</span> Vivian Perez   <span class="dv">996</span> Wycliff Ave   <span class="dv">14</span>    <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Explanation of the Code:</strong></p>
<ul>
<li>We first load the datasets using the <code>load</code> function.</li>
<li>We then use the <code>stringdist_left_join</code> function from the <code>fuzzyjoin</code> package to perform the fuzzy join. The <code>by</code> argument specifies the column to join on (<code>name</code>), and the <code>max_dist</code> argument specifies the maximum allowable distance for matches (2 in this case).</li>
<li>The <code>distance_col</code> argument adds a column to the result showing the computed distance between the matched names.</li>
<li>Finally, we display the result to see which customer records were matched based on fuzzy name matching.</li>
</ul>
</section>
<section id="interpretation-of-results-3" class="level4">
<h4 class="anchored" data-anchor-id="interpretation-of-results-3">Interpretation of Results</h4>
<p>The resulting dataset <code>customer_matches</code> contains rows from <code>customer_records_A</code> matched with the closest approximate rows from <code>customer_records_B</code> based on the <code>name</code> column. The <code>dist</code> column shows the computed distance between the matched names.</p>
<p>In this final installment of our series, “Joins Are No Mystery Anymore: Hands-On Tutorial,” we’ve taken a deep dive into specialized join techniques that are essential for handling more complex data scenarios. We’ve covered:</p>
<ul>
<li><strong>Non-Equi Join</strong>: Matching rows based on non-equality conditions, useful for comparing ranges or thresholds.</li>
<li><strong>Rolling Join</strong>: Joining tables to find the nearest matches when an exact match is not found, ideal for time series data.</li>
<li><strong>Overlap Join</strong>: Identifying overlapping ranges, such as booking dates or project timelines.</li>
<li><strong>Fuzzy Join</strong>: Combining tables based on approximate matches, invaluable for dealing with inconsistent data.</li>
</ul>
<p>Through practical examples and detailed code walkthroughs, we demonstrated how these advanced joins can solve real-world data problems. We’ve also provided homework tasks to reinforce your learning and give you hands-on experience with these techniques.</p>
</section>
<section id="whats-next" class="level4">
<h4 class="anchored" data-anchor-id="whats-next">What’s Next?</h4>
<p>In the bonus section, “Anatomy of a Basic Joining Function,” we’ll explore the different arguments in joining functions, explaining what each one does and how they change the output. This deep dive will enhance your understanding and give you even greater control over your data analysis.</p>
<p>Stay tuned as we uncover the intricacies of joining functions and provide you with the tools to master data joins in R. Thank you for joining us on this journey, and happy coding!</p>
</section>
</section>
<section id="anatomy-of-basic-join-functions-from-dplyr" class="level3">
<h3 class="anchored" data-anchor-id="anatomy-of-basic-join-functions-from-dplyr">Anatomy of Basic Join Functions (from dplyr)</h3>
<p>In this section, we’ll delve into the anatomy of basic joining functions in the <code>dplyr</code> package. We’ll explain the different arguments you can use, how they affect the output, and provide examples to illustrate their usage.</p>
<section id="by" class="level4">
<h4 class="anchored" data-anchor-id="by">1. <code>by</code></h4>
<p>Specifies the columns to join by. If not provided, <code>dplyr</code> will join by columns with the same name in both tables.</p>
</section>
<section id="suffix" class="level4">
<h4 class="anchored" data-anchor-id="suffix">2. <code>suffix</code></h4>
<p>Determines the suffixes added to duplicate column names from the left and right tables. By default, it is set to <code>c(".x", ".y")</code>.</p>
</section>
<section id="copy" class="level4">
<h4 class="anchored" data-anchor-id="copy">3. <code>copy</code></h4>
<p>A logical argument that allows joining of data frames located in different databases. By default, it is set to <code>FALSE</code>.</p>
</section>
<section id="keep" class="level4">
<h4 class="anchored" data-anchor-id="keep">4. <code>keep</code></h4>
<p>An argument in <code>full_join</code> that keeps the join columns in the output.</p>
<p><strong>Example</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of different arguments in a join function</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>joined_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> df1, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> df2, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"id"</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_left"</span>, <span class="st">"_right"</span>), </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">copy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">keep =</span> <span class="cn">TRUE</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>For everybody, not to be fooled by numbers</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>